<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <meta name="author" content="Laurent Leseigneur">
    <meta name="author" content="Emmanuel Duchastenier">


    <title>Agile Grenoble 2017</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/bonitasoft.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
</head>
<body>
<div class="reveal">
    <section class="slides">
        <section title="intro">
            <h1>Bonitasoft</h1>
            <ul>
                <li>règle N°1 : changer les règles en mode bottom-up</li>
                <li>règle N°2 : ne jamais changer la règle N°1</li>
            </ul>
        </section>

        <section title="Bonitasoft documentation website">
            <section data-markdown>
                # Cas d'utilisation
                ## Le site public contenant la _documentation_ du produit
            </section>
            <section>
                <div data-markdown>
                    ## le problème
                    ### La doc
                    * sur un Drupal personnalisé par l’équipe IT (obscur pour la R&amp;D)
                    * 1 seule personne met à jour la doc
                    * Le versionning Drupal est compliqué (1 copie par version)
                    * La mise en production est peu fréquente et douloureuse
                    * acces utilisateur fermé par login
                </div>
                <aside class="notes">
                    section à remettre en forme...
                </aside>
            </section>
            <section>
                <ul style="list-style: none">
                    <li><img src="images/sad_icon.png" style="vertical-align: middle"/> On ne se sent pas propriétaire du contenu de la documentation.</li>
                    <li><img src="images/sad_icon.png" style="vertical-align: middle"/> Aucun report facile d’une modification sur toutes les versions supérieures. L'oubli est fréquent.</li>
                    <li><img src="images/sad_icon.png" style="vertical-align: middle"/> Pas de flux de vérification : pas d'aperçu du rendu final avant sa réelle publication.</li>
                </ul>
            </section>
            <section data-markdown>
                ![Thinking](images/monkey_thinking.jpeg)
                ## Nécessité de changer le processus
            </section>
            <section data-markdown>
                ## Oui, mais pour qui?
                ![Personas](images/4_personas.jpg)
            </section>
            <section>
                    <div data-markdown>
                    ## Personas
                    ### Richard
                    L'utilisateur (payant / de la communauté) qui lit la doc en ligne. Il est consommateur du contenu.
                    ### Manu
                    Le développeur de la R&D qui maintient la doc à jour. Il est producteur de contenu.
                    ### Jérôme
                    Une personne du support client & un consultant qui font face aux clients perdus dans la doc. Ils sont facilitateurs pour améliorer la qualité du contenu.
                    </div>
                    <aside class="notes">
                        Jérôme va par exemple ouvrir un bug de doc / proposer un squelette de PR d'amélioration d'un page de doc. (Pull Request non-encore définie pour le moment, on y vient. C'est du teasing!)
                    </aside>
                </section>
                <section>
                    <div data-markdown>
                        ## Janvier 2016, la documentation passe en Open Source.
                        * indexation possible par les moteurs de recherche: suppression du login obligatoire
                        * bookmarks possibles
                        * meilleur moteur de recherche intégré au site
                    </div>
                    <aside class="notes">C'est un Choix d'entreprise</aside>
                </section>
                <section>
                    <div data-markdown>
                        ## Tout le contenu passe sous Contrôle de Version: Github
                        * permet un flux standard de contribution / revue de contenu
                        * on écrit la doc en [markdown](https://fr.wikipedia.org/wiki/Markdown). C'est plus facile à écrire que du ~~HTML~~.
                        * contribution par Pull Request exclusivement. C'est la “norme” de développement chez Bonitasoft.
                        * la PR peut être revue par Jérôme, c'est notre sceau de qualité.
                    </div>
                    <aside class="notes"></aside>
                </section>
                <section>
                    <div data-markdown>
                        ## Mise en pre-production / production automatisée
                    </div>
                    <aside class="notes"></aside>
                </section>
                <section>
                    <div data-markdown>
                        ## Et on vit ainsi dans un monde idéal?
                    </div>
                        <div class="fragment" data-markdown>### Les effets secondaires</div>
                    <aside class="notes"></aside>
                </section>
                <section>
                    <div data-markdown>
                    </div>
                    <aside class="notes">(TODO: SCREENSHOT)</aside>
                </section>
                <section>
                    <div data-markdown>
                    </div>
                    <aside class="notes"></aside>
                </section>


                <section>
                <img src="images/doc_PR_flow.png"/>
            </section>
        </section>

        <section title="Engine tests on all DB vendor">
            <section>
                <h2>Lancer les tests d'intégration sur différents types de base de données</h2>
                <div class="fragment">1 contrainte: Bonita supporte Oracle, PostgreSQL, MySQL, SQL Server</div>
                <div class="fragment">1 constat: h2 en mode émulation est rapide, mais ne valide pas la compatibilité sur les autres DB vendors</div>
            </section>
            <section align="center">
                <h2>Notre produit doit être compatible sur</h2>
                <img src="images/logo-mysql.png" border="0 px">
                <img src="images/logo-postgresql.png" border="0 px">
                <img src="images/logo-oracle.png" width="256px" height="256px">
                <img src="images/logo-sqlserver.png" width="256px">
            </section>
            <section align="center">
                <h2>Avant</h2>
                <img src="images/old_computer.jpg">

                <aside class="notes" data-markdown>
                    On dépendait de serveur de base de données qui devait:
                    * être up
                    * avoir la bonne configuration
                    * les instances de base de données / schéma devait être créées
                </aside>
            </section>

            <section>
                <div data-markdown>
                    ## Ce qu'on a mis en place
                    Utilisation d’images docker déjà tunées pour les bases de donnée supportée:
                    * La **configuration** est déjà dans l'image
                    * Les **schémas** nécessaires sont déjà dans l'image
                    * Les **users** de connexion sont déjà dans l'image
                </div>
                <aside class="notes" data-markdown>
                    Config: support des transactions XA (Oracle),
                    max Prepared statement (PostgreSQL)
                </aside>
            </section>
            <section data-markdown>
                A chaque lancement des tests d'intégration, on lance un nouveau conteneur Docker
            </section>
            <section align="center">
                <h3>ça a rendu nos vies meilleurs</h3>
                <img src="images/route_bonheur.png"/>
                <aside>

                </aside>
            </section>
            <section>
                <h2>Bénéfices observés pour le persona "DAVE"</h2>
                <div class="fragment">Entre 20s & 1mn pour avoir une DB up & running. C’est plus rapide que d’aller voir Jeremy pour lui demander un serveur et
                    l’installer.
                </div>
                <div class="fragment">Aucun état initial requis, on recrée le container à chaque fois</div>
                <div class="fragment">Ça tourne aussi bien localement que sur une CI</div>
                <div class="fragment">Environnements plus stables</div>
                <div class="fragment">On n'a pas à maintenir à la main x bases de données</div>
                <div class="fragment">On n'est plus dépendant d’un devops / IT</div>
            </section>
            <section data-markdown>
                ## Comment?
                * Activation par profils maven (1 profil pour chaque DB vendor)
                * Utilisation d'un plugin Maven pour lancer un nouveau conteneur Docker à partir d'une image
                * Idem avec plugin gradle
                <aside>
                    TODO : ref plugin gradle
                    example de code maven/gradle
                </aside>
            </section>
            <section>
                <div data-markdown>
                    ## mais encore?

                    Le plugin Maven permet de choisir un port aléatoire. Plus de conflit de ports.

                    ![pigs rushing](images/pig_rush.jpg)

                    Docker permet d'attendre la fin réelle du démarrage du conteneur avant de lancer les tests.
                </div>
                <aside class="notes" data-markdown>HealthCheck</aside>
            </section>
            <section>
                <div data-markdown>
                    ## Limitations
                    Pas d'image docker pour MS SQL Server (compatible avec bonita) . Ces tests tournent toujours "à l'ancienne".
                </div>
                <aside class="notes" data-markdown>
                    Transactions distribuées XA pas supportées dans l'image docker SQL Server
                    contraintes peu compatible avec une intégration continue sur les volumes de stockage
                </aside>
            </section>
        </section>
        <section title="ICI">
            <section>
                <div>
                    <h2>ICI</h2>
                    <p class="fragment">Nouveau module complémentaire à Bonita
                    </p>
                    <div class="fragment">
                        <p>Requiert:</p>
                        <ul>
                            <li>Bonita</li>
                            <li>une Base de donnée</li>
                            <li>Elasticsearch</li>
                            <li>ICI</li>
                        </ul>
                    </div>
                </div>
                <aside class="notes">
                    <p>on part d'une page blanche
                    tout est permis.
                    </p>
                    <p>interconnexion entre les composants
                    </p>
                </aside>
            </section>
            <section>
                <div data-markdown>
                    ## Personas
                    ### Nathalie
                    Product Owner et Ergonome.
                    ### Luis
                    Développeur front end de la UI mobile first.
                    ### Philippe
                    Sponsor du projet.
                </div>
                <aside class="notes">
                    Approche User Centric Design
                </aside>
            </section>
            <section>
                <div data-markdown>
                ## Feuille blanche

                * Maven -> Gradle
                * Jenkinsfile
                * Docker compose

                    
              
                </div>
                <aside class="notes">
                    leçon apprise: on a enlevé le deploy systématique des PR. content de savoit le faire, mais inutile
                    et consommateur de ressources (8PR ouvertes = 32 container Dockers

                    ports aléatoires publiés en commentaire de la pull requets sur github
                </aside>
            </section>
            <section>
                <div>
                    <h2>Master vert</h2>
                    <div class="fragment">
                        <p>4 conteneurs Docker deployés sur des ports figés (bookmark possible)</p>
                    </div>
                    <div class="fragment">
                        <h2>Pull Request pour tests utilisateur</h2>

                        <div class="fragment">
                            <p>4 container deployés sur des ports aléatoires</p>
                            <p>supprimés lorsque la PR est fermée</p>
                        </div>
                    </div>
                </div>
                <aside class="notes">
                    leçon apprise: on a enlevé le deploy systématique des PR. content de savoit le faire, mais inutile
                    et consommateur de ressources (8PR ouvertes = 32 container Dockers

                    ports aléatoires publiés en commentaire de la pull requets sur github
                </aside>
            </section>
        </section>
        <section title="Conclusion">
            <section data-markdown>
                ## Références

                Plugin Maven Docker: [Fabric8](https://maven.fabric8.io/)
            </section>
        </section>
    </section>
</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
</script>
</body>
</html>
